opt_attention = {
    0: {"sparsity": 0.000028594806397169894},
    1: {"sparsity": 0.015042197149766325},
    2: {"sparsity": 0.06152616288070831},
    3: {"sparsity": 0.0472950691867692},
    4: {"sparsity": 0.07715765610884068},
    5: {"sparsity": 0.11076047353194109},
    6: {"sparsity": 0.1682180437298669},
    7: {"sparsity": 0.20804124167529056},
    8: {"sparsity": 0.1982870200397979},
    9: {"sparsity": 0.22609002773510026},
    10: {"sparsity": 0.296498577396606},
    11: {"sparsity": 0.3077317268341693},
    12: {"sparsity": 0.35982062407658083},
    13: {"sparsity": 0.3525948917371384},
    14: {"sparsity": 0.38358327853465057},
    15: {"sparsity": 0.44670542677501194},
    16: {"sparsity": 0.4567046310950634},
    17: {"sparsity": 0.4842285703252528},
    18: {"sparsity": 0.529715918552997},
    19: {"sparsity": 0.526690847945737},
    20: {"sparsity": 0.5804056029899557},
    21: {"sparsity": 0.5909725897278959},
    22: {"sparsity": 0.5745976955610271},
    23: {"sparsity": 0.5650659465455012},
    24: {"sparsity": 0.5915049468305152},
    25: {"sparsity": 0.5859766854349552},
    26: {"sparsity": 0.5518050321669553},
    27: {"sparsity": 0.5690685971180273},
    28: {"sparsity": 0.5796574958042748},
    29: {"sparsity": 0.5756837079482205},
    30: {"sparsity": 0.5955122902065867},
    31: {"sparsity": 0.5278710871801772}
}


opt_mlp = {
    0:  {"sparsity": 0.86602783203125},
    1:  {"sparsity": 0.986083984375},
    2:  {"sparsity": 0.17877197265625},
    3:  {"sparsity": 0.01153564453125},
    4:  {"sparsity": 0.15374755859375},
    5:  {"sparsity": 0.8817138671875},
    6:  {"sparsity": 0.761962890625},
    7:  {"sparsity": 0.7447509765625},
    8:  {"sparsity": 0.86566162109375},
    9:  {"sparsity": 0.82989501953125},
    10: {"sparsity": 0.8182373046875},
    11: {"sparsity": 0.7852783203125},
    12: {"sparsity": 0.73626708984375},
    13: {"sparsity": 0.6812744140625},
    14: {"sparsity": 0.67376708984375},
    15: {"sparsity": 0.703125},
    16: {"sparsity": 0.62652587890625},
    17: {"sparsity": 0.56707763671875},
    18: {"sparsity": 0.558349609375},
    19: {"sparsity": 0.55169677734375},
    20: {"sparsity": 0.48590087890625},
    21: {"sparsity": 0.47100830078125},
    22: {"sparsity": 0.433837890625},
    23: {"sparsity": 0.39703369140625},
    24: {"sparsity": 0.45623779296875},
    25: {"sparsity": 0.45379638671875},
    26: {"sparsity": 0.408203125},
    27: {"sparsity": 0.345947265625},
    28: {"sparsity": 0.30059814453125},
    29: {"sparsity": 0.24163818359375},
    30: {"sparsity": 0.23883056640625},
    31: {"sparsity": 0.3763427734375}
}


llama_attention = {
    0:  {"sparsity": 0.008743247382148816},
    1:  {"sparsity": 0.02999946223886659},
    2:  {"sparsity": 0.048748534081544006},
    3:  {"sparsity": 0.08258946309255888},
    4:  {"sparsity": 0.08427018929179942},
    5:  {"sparsity": 0.11850877562885441},
    6:  {"sparsity": 0.1389847716147578},
    7:  {"sparsity": 0.20659055836852922},
    8:  {"sparsity": 0.22109140901573636},
    9:  {"sparsity": 0.27194763902809654},
    10: {"sparsity": 0.28984935125981975},
    11: {"sparsity": 0.3067634855948319},
    12: {"sparsity": 0.36195445151580687},
    13: {"sparsity": 0.3806831174656675},
    14: {"sparsity": 0.38938077811102393},
    15: {"sparsity": 0.4258779259698392},
    16: {"sparsity": 0.4694467188979652},
    17: {"sparsity": 0.4822554658062046},
    18: {"sparsity": 0.5024972271661086},
    19: {"sparsity": 0.5699875620160969},
    20: {"sparsity": 0.5612715374083596},
    21: {"sparsity": 0.5666555302505887},
    22: {"sparsity": 0.5845499741741004},
    23: {"sparsity": 0.5937885250094109},
    24: {"sparsity": 0.5537018463896609},
    25: {"sparsity": 0.5847327727443686},
    26: {"sparsity": 0.5969252078309926},
    27: {"sparsity": 0.5967266811583268},
    28: {"sparsity": 0.559187781682627},
    29: {"sparsity": 0.5713761984316554},
    30: {"sparsity": 0.561206086336281},
    31: {"sparsity": 0.511608710817088}
}


llama_mlp = {
    0:  {"sparsity": 0.4721146403084233},
    1:  {"sparsity": 0.5949978489554666},
    2:  {"sparsity": 0.5449941363261762},
    3:  {"sparsity": 0.5553578523702354},
    4:  {"sparsity": 0.45270575716719753},
    5:  {"sparsity": 0.46466010251541776},
    6:  {"sparsity": 0.4215640864590309},
    7:  {"sparsity": 0.5826122334741168},
    8:  {"sparsity": 0.5156156360629459},
    9:  {"sparsity": 0.5940405561123859},
    10: {"sparsity": 0.5562724050392793},
    11: {"sparsity": 0.4989289423793275},
    12: {"sparsity": 0.5946928060632273},
    13: {"sparsity": 0.5602324698626703},
    14: {"sparsity": 0.4700231124440953},
    15: {"sparsity": 0.4910117038793567},
    16: {"sparsity": 0.5559118755918607},
    17: {"sparsity": 0.4821468632248183},
    18: {"sparsity": 0.4381139086644347},
    19: {"sparsity": 0.5987002480643878},
    20: {"sparsity": 0.4388361496334384},
    21: {"sparsity": 0.4603721210023546},
    22: {"sparsity": 0.5319498966964017},
    23: {"sparsity": 0.5689041000376437},
    24: {"sparsity": 0.4085573855586437},
    25: {"sparsity": 0.5326810909774746},
    26: {"sparsity": 0.5814508313239704},
    27: {"sparsity": 0.5806567246333072},
    28: {"sparsity": 0.430501126730508},
    29: {"sparsity": 0.4792547937266218},
    30: {"sparsity": 0.438574345345124},
    31: {"sparsity": 0.4540536426612365}
}

ACTIVATION_OFFLOAD_LIMITS_BASE = {i: 500000000 for i in range(32)}


ACTIVATION_OFFLOAD_LIMITS_OURS = {
    0:  1e9,
    1:  1e9,
    2:  7e8,
    3:  7e8,
    4:  7e8,
    5:  7e8,
    6:  6e8,
    7:  6e8,
    8:  6e8,
    9:  6e8,
    10: 6e8,
    11: 6e8,
    12: 6e8,
    13: 6e8,
    14: 6e8,
    15: 6e8,
    16: 6e8,
    17: 5e8,
    18: 5e8,
    19: 5e8,
    20: 5e8,
    21: 4e8,
    22: 4e8,
    23: 3e8,
    24: 3e8,
    25: 2e8,
    26: 9e7,
    27: 8e7,
    28: 7e7,
    29: 6e7,
    30: 5e7,
    31: 0,
}